QUERY PLAN with POSTGRESQL LPCE-I                                                                                                       QUERY PLAN                                                                                                    
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=1099882.17..1099882.18 rows=1 width=8) (actual time=10041.967..10041.976 rows=1 loops=1)
   ->  Hash Join  (cost=412529.07..1099872.57 rows=3841 width=0) (actual time=8667.447..9794.561 rows=7896000 loops=1)
         Hash Cond: (ci.movie_id = t.id)
         ->  Seq Scan on cast_info ci  (cost=0.00..683910.90 rows=913722 width=4) (actual time=0.024..2538.869 rows=30050856 loops=1)
               Filter: (person_id < 3031625)
               Rows Removed by Filter: 6193488
         ->  Hash  (cost=412507.84..412507.84 rows=1699 width=28) (actual time=2277.392..2277.392 rows=197400 loops=1)
               Buckets: 65536 (originally 2048)  Batches: 2 (originally 1)  Memory Usage: 11567kB
               ->  Hash Join  (cost=146819.20..412507.84 rows=1699 width=28) (actual time=2015.389..2248.808 rows=197400 loops=1)
                     Hash Cond: (mk.keyword_id = k.id)
                     ->  Hash Join  (cost=144409.92..410093.73 rows=1053 width=32) (actual time=2002.650..2163.259 rows=1250200 loops=1)
                           Hash Cond: (mi.movie_id = t.id)
                           ->  Seq Scan on movie_info mi  (cost=0.00..265642.62 rows=10973 width=4) (actual time=54.823..757.133 rows=660923 loops=1)
                                 Filter: (info_type_id = 18)
                                 Rows Removed by Filter: 14174797
                           ->  Hash  (cost=144397.40..144397.40 rows=1001 width=28) (actual time=1166.402..1166.402 rows=178600 loops=1)
                                 Buckets: 65536 (originally 1024)  Batches: 2 (originally 1)  Memory Usage: 10465kB
                                 ->  Nested Loop  (cost=62579.40..144397.40 rows=1001 width=28) (actual time=708.321..1130.707 rows=178600 loops=1)
                                       Join Filter: (mc.movie_id = t.id)
                                       ->  Hash Join  (cost=62578.97..143632.68 rows=1072 width=24) (actual time=406.479..640.454 rows=253672 loops=1)
                                             Hash Cond: (mk.movie_id = mc.movie_id)
                                             ->  Seq Scan on movie_keyword mk  (cost=0.00..81003.12 rows=13420 width=8) (actual time=0.012..207.259 rows=194133 loops=1)
                                                   Filter: (id < 194134)
                                                   Rows Removed by Filter: 4329797
                                             ->  Hash  (cost=62566.71..62566.71 rows=981 width=16) (actual time=397.974..397.974 rows=12664 loops=1)
                                                   Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 722kB
                                                   ->  Hash Join  (cost=50889.12..62566.71 rows=981 width=16) (actual time=348.326..396.660 rows=12664 loops=1)
                                                         Hash Cond: (at.movie_id = mc.movie_id)
                                                         ->  Seq Scan on aka_title at  (cost=0.00..10318.72 rows=361472 width=4) (actual time=0.971..25.612 rows=361472 loops=1)
                                                         ->  Hash  (cost=50883.20..50883.20 rows=473 width=12) (actual time=346.739..346.739 rows=5940 loops=1)
                                                               Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 320kB
                                                               ->  Hash Join  (cost=49766.77..50883.20 rows=473 width=12) (actual time=330.570..346.191 rows=5940 loops=1)
                                                                     Hash Cond: (ml.movie_id = mc.movie_id)
                                                                     ->  Seq Scan on movie_link ml  (cost=0.00..1074.93 rows=10627 width=4) (actual time=0.016..5.549 rows=50238 loops=1)
                                                                           Filter: (linked_movie_id > 331751)
                                                                           Rows Removed by Filter: 9756
                                                                     ->  Hash  (cost=49667.09..49667.09 rows=7974 width=8) (actual time=330.442..330.442 rows=122377 loops=1)
                                                                           Buckets: 131072 (originally 8192)  Batches: 2 (originally 1)  Memory Usage: 3423kB
                                                                           ->  Hash Join  (cost=2517.97..49667.09 rows=7974 width=8) (actual time=52.115..316.233 rows=122377 loops=1)
                                                                                 Hash Cond: (mc.movie_id = cc.movie_id)
                                                                                 ->  Seq Scan on movie_companies mc  (cost=0.00..46718.11 rows=83619 width=4) (actual time=39.251..161.691 rows=1740219 loops=1)
                                                                                       Filter: (id > 868910)
                                                                                       Rows Removed by Filter: 868910
                                                                                 ->  Hash  (cost=2419.57..2419.57 rows=7872 width=4) (actual time=12.773..12.773 rows=49145 loops=1)
                                                                                       Buckets: 65536 (originally 8192)  Batches: 1 (originally 1)  Memory Usage: 2240kB
                                                                                       ->  Seq Scan on complete_cast cc  (cost=0.00..2419.57 rows=7872 width=4) (actual time=4.060..8.086 rows=49145 loops=1)
                                                                                             Filter: (subject_id = 2)
                                                                                             Rows Removed by Filter: 85941
                                       ->  Index Scan using title_pkey on title t  (cost=0.43..0.70 rows=1 width=4) (actual time=0.001..0.001 rows=1 loops=253672)
                                             Index Cond: (id = at.movie_id)
                                             Filter: (production_year > 1885)
                                             Rows Removed by Filter: 0
                     ->  Hash  (cost=2271.12..2271.12 rows=11053 width=4) (actual time=12.660..12.660 rows=43596 loops=1)
                           Buckets: 65536 (originally 16384)  Batches: 1 (originally 1)  Memory Usage: 2045kB
                           ->  Seq Scan on keyword k  (cost=0.00..2271.12 rows=11053 width=4) (actual time=0.008..8.396 rows=43596 loops=1)
                                 Filter: (keyword > 90573)
                                 Rows Removed by Filter: 90574
 Planning Time: 781.331 ms
 Execution Time: 10051.267 ms
(59 rows)






 
 
 
 
 
 
QUERY PLAN with POSTGRESQL LPCE-R      
 ---------------------------------------------------------------------------------------
 ----------------  Query Re-optimization Plan with Updated Cardinality   ---------------
 Aggregate  (cost=964470.31..964470.32 rows=1 width=8) (actual time=54043.723..54043.731 rows=1 loops=1)
   ->  Nested Loop  (cost=270021.55..964349.94 rows=48149 width=0) (actual time=16798.392..53535.902 rows=7896000 loops=1)
         ->  Hash Join  (cost=270021.12..957504.19 rows=13634 width=28) (actual time=6819.600..11101.288 rows=21546048 loops=1)
               Hash Cond: (ci.movie_id = mc.movie_id)
               ->  Seq Scan on cast_info ci  (cost=0.00..683910.90 rows=913722 width=4) (actual time=0.020..2568.302 rows=30050856 loops=1)
                     Filter: (person_id < 3031625)
                     Rows Removed by Filter: 6193488
               ->  Hash  (cost=269814.48..269814.48 rows=16531 width=24) (actual time=1593.184..1593.184 rows=530328 loops=1)
                     Buckets: 65536 (originally 32768)  Batches: 2 (originally 1)  Memory Usage: 29003kB
                     ->  Hash Join  (cost=4127.77..269814.48 rows=16531 width=24) (actual time=683.976..1526.283 rows=530328 loops=1)
                           Hash Cond: (mi.movie_id = mc.movie_id)
                           ->  Seq Scan on movie_info mi  (cost=0.00..265642.62 rows=10973 width=4) (actual time=0.144..759.811 rows=660923 loops=1)
                                 Filter: (info_type_id = 18)
                                 Rows Removed by Filter: 14174797
                           ->  Hash  (cost=3957.42..3957.42 rows=13628 width=20) (actual time=681.525..681.525 rows=47784 loops=1)
                                 Buckets: 65536 (originally 16384)  Batches: 1 (originally 1)  Memory Usage: 2939kB
                                 ->  Hash Join  (cost=2816.07..3957.42 rows=13628 width=20) (actual time=450.569..676.309 rows=47784 loops=1)
                                       Hash Cond: (mk.keyword_id = k.id)
                                       ->  Hash Join  (cost=76345.02..158124.36 rows=253672 width=24) (actual time=416.124..646.642 rows=253672 loops=1)
                                             Hash Cond: (mk.movie_id = mc.movie_id)
                                             ->  Seq Scan on movie_keyword mk  (cost=0.00..81003.12 rows=194133 width=8) (actual time=0.036..206.117 rows=194133 loops=1)
                                                   Filter: (id < 194134)
                                                   Rows Removed by Filter: 4329797
                                             ->  Hash  (cost=76186.72..76186.72 rows=12664 width=16) (actual time=407.372..407.372 rows=12664 loops=1)
                                                   Buckets: 16384  Batches: 1  Memory Usage: 722kB
                                                   ->  Hash Join  (cost=64470.37..76186.72 rows=12664 width=16) (actual time=359.217..406.191 rows=12664 loops=1)
                                                         Hash Cond: (at.movie_id = mc.movie_id)
                                                         ->  Seq Scan on aka_title at  (cost=0.00..10318.72 rows=361472 width=4) (actual time=1.057..24.966 rows=361472 lo
ops=1)
                                                         ->  Hash  (cost=64396.12..64396.12 rows=5940 width=12) (actual time=357.449..357.449 rows=5940 loops=1)
                                                               Buckets: 8192  Batches: 1  Memory Usage: 320kB
                                                               ->  Hash Join  (cost=62139.22..64396.12 rows=5940 width=12) (actual time=343.440..356.909 rows=5940 loops=1)
                                                                     Hash Cond: (ml.movie_id = mc.movie_id)
                                                                     ->  Seq Scan on movie_link ml  (cost=0.00..1074.93 rows=50238 width=4) (actual time=0.007..4.884 rows=50238 loops=1)
                                                                           Filter: (linked_movie_id > 331751)
                                                                           Rows Removed by Filter: 9756
                                                                     ->  Hash  (cost=60130.51..60130.51 rows=122377 width=8) (actual time=342.953..342.953 rows=122377 loops=1)
                                                                           Buckets: 131072  Batches: 2  Memory Usage: 3429kB
                                                                           ->  Hash Join  (cost=3033.89..60130.51 rows=122377 width=8) (actual time=54.374..328.601 rows=122377 loops=1)
                                                                                 Hash Cond: (mc.movie_id = cc.movie_id)
                                                                                 ->  Seq Scan on movie_companies mc  (cost=0.00..46718.11 rows=1740219 width=4) (actual time=40.391..163.456 rows=1740219 loops=1)
                                                                                       Filter: (id > 868910)
                                                                                       Rows Removed by Filter: 868910
                                                                                 ->  Hash  (cost=2419.57..2419.57 rows=49145 width=4) (actual time=13.704..13.704 rows=49145 loops=1)
                                                                                       Buckets: 65536  Batches: 1  Memory Usage: 2240kB
                                                                                       ->  Seq Scan on complete_cast cc  (cost=0.00..2419.57 rows=49145 width=4) (actual time=4.205..9.351 rows=49145 loops=1)
                                                                                             Filter: (subject_id = 2)
                                                                                             Rows Removed by Filter: 85941
                                       ->  Hash  (cost=2271.12..2271.12 rows=43596 width=4) (actual time=14.742..14.742 rows=43596 loops=1)
                                             Buckets: 65536  Batches: 1  Memory Usage: 2045kB
                                             ->  Seq Scan on keyword k  (cost=0.00..2271.12 rows=43596 width=4) (actual time=0.006..10.581 rows=43596 loops=1)
                                                   Filter: (keyword > 90573)
                                                   Rows Removed by Filter: 90574
         ->  Index Scan using title_pkey on title t  (cost=0.43..0.50 rows=1 width=4) (actual time=0.001..0.001 rows=0 loops=21546048)
               Index Cond: (id = mc.movie_id)
               Filter: (production_year > 1885)
               Rows Removed by Filter: 1
 Planning Time: 1139.620 ms
 Execution Time: 54046.179 ms
